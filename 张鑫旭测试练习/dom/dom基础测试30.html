<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title></title>
    <meta name="viewport"
        content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no,minimal-ui">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="renderer" content="webkit">
    <meta name="force-rendering" content="webkit">
    <style>
        .slider {
            padding: 5px 0;
            position: relative;
            margin: 130px 10%;
            --percent: 0;
        }
        .slider-track {
            display: block;
            width: 100%; height: 6px;
            background-color: lightgray;
            border: 0; padding: 0;
        }
        .slider-track::before {
            content: '';
            display: block;
            height: 100%;
            background-color: skyblue;
            width: calc(1% * var(--percent));
        }
        .slider-thumb {
            position: absolute;
            width: 16px; height: 16px;
            border: 0; padding: 0;
            background: #fff;
            box-shadow: 0 0 0 1px skyblue;
            border-radius: 50%;
            left: calc(1% * var(--percent)); top: 0;
            margin: auto -8px;
            cursor: pointer;
        }
        .slider-thumb::before,.slider-thumb::after{
            content: ' ';
            position: absolute;
            transform: translate(-50%,-30px);
            opacity: 0;
            transition: transform .3s,opacity .3s;
        }
        .slider-thumb::before{
            bottom: 20px;
            width: 0;
            height: 0;
            border: 5px solid rgba(0,0,0,.7);
            border-left-color: transparent;
            border-right-color: transparent;
            border-bottom-width: 0;
        }
        .slider-thumb::after{
            /* 这里可以用计算器 */
            /* content: attr(data-percent); */
            counter-reset: percent var(--percent);
            content: counter(percent);
            bottom: 25px;
            width: 30px;
            height: 20px;
            line-height: 20px;
            background-color: rgba(0,0,0,.7);
            color: #fff;
            text-align: center;
            border-radius: 5px;
            font-size: 14px;
        }
        .slider-thumb:hover{
            box-shadow: 0 0 1px 3px skyblue;
        }
        .slider-thumb:hover::before,.slider-thumb:hover::after{
            transform: translate(-50%,0);
            opacity: 1;
        }
        .slider button{
            outline: none;
        }
    </style>
</head>

<body>
    <div class="slider">
        <button class="slider-track"></button>
        <button class="slider-thumb" data-percent='50'></button>
    </div>
</body>
<script>
    (function(){
        let slider=document.querySelectorAll('.slider')[0],
            sliderTrack=document.querySelectorAll('.slider-track')[0],
            sliderThumb=document.querySelectorAll('.slider-thumb')[0];
        let _r=sliderTrack.getBoundingClientRect();
        let each=_r.width/100,
            _left=_r.left,
            currentPosition=50,
            latch=false;


        (function info(){
            setSpeed(currentPosition);
        })();
        

        sliderTrack.addEventListener('click',function(e){
            let _x=e.pageX-_left;
            setSpeed(Math.ceil(_x/each));
        })
        
        //pc端 拖拽
        sliderThumb.addEventListener('mousedown',function(e){
            latch=true;
        })
        slider.addEventListener('mousemove',function(e){
            if(!latch)return;
            let _x=e.pageX-_left;
            setSpeed(Math.ceil(_x/each));
        })
        document.addEventListener('mouseup',function(e){
            latch=false;
        })

        //移动端 拖拽
        sliderThumb.addEventListener('touchstart',function(e){
            latch=true;
        })
        slider.addEventListener('touchmove',function(e){
            if(!latch)return;
            let _x=e.changedTouches[0].pageX-_left;
            setSpeed(Math.ceil(_x/each));
        })
        document.addEventListener('touchend',function(e){
            latch=false;
        })

        function setSpeed(i){
            if(i<0 || i>100)return;
            slider.style.setProperty('--percent',i);
            // sliderThumb.setAttribute('data-percent',i);
        }
    })()
</script>
</html>